<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Standalone content classifier for decrypted TLS payloads."><title>busted_classifier - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-b7b9f40b.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="busted_classifier" data-themes="" data-resource-suffix="" data-rustdoc-version="1.95.0-nightly (6efa357bf 2026-02-08)" data-channel="nightly" data-search-js="search-fb33671b.js" data-stringdex-js="stringdex-b897f86f.js" data-settings-js="settings-170eb4bf.js" ><script src="../static.files/storage-f9617a14.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-12f88f4f.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-f7c3ffd8.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><a class="skip-main-content" href="#main-content">Skip to main content</a><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Crate busted_classifier</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../busted_classifier/index.html">busted_<wbr>classifier</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#architecture" title="Architecture">Architecture</a></li><li><a href="#usage" title="Usage">Usage</a></li><li><a href="#feature-flags" title="Feature Flags">Feature Flags</a></li></ul><h3><a href="#reexports">Crate Items</a></h3><ul class="block"><li><a href="#reexports" title="Re-exports">Re-exports</a></li><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content" tabindex="-1"><div class="main-heading"><h1>Crate <span>busted_<wbr>classifier</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/busted_classifier/lib.rs.html#1-518">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Standalone content classifier for decrypted TLS payloads.</p>
<p><code>busted-classifier</code> is a multi-layer analysis pipeline that classifies intercepted
network traffic as LLM API calls, MCP protocol messages, or generic HTTP. It operates
on raw byte slices without any connection state, making it safe to call from any context.</p>
<h2 id="architecture"><a class="doc-anchor" href="#architecture">§</a>Architecture</h2>
<p>Classification proceeds through four layers:</p>
<ol>
<li><strong>Protocol detection</strong> — HTTP/1.1 request/response parsing (via [<code>nom</code>]),
HTTP/2 binary framing detection, and SSE stream identification.</li>
<li><strong>Content classification</strong> — Matches against known LLM API endpoints
(OpenAI, Anthropic, Google, Azure, AWS Bedrock, Cohere, Mistral, Groq, etc.)
and detects MCP JSON-RPC 2.0 methods.</li>
<li><strong>Agent fingerprinting</strong> — Extracts SDK name/version from <code>User-Agent</code> headers,
model parameters from JSON bodies, and computes a behavioral signature hash.</li>
<li><strong>PII detection</strong> — Scans for email addresses, credit card numbers, SSNs,
phone numbers, and API keys (requires <code>pii</code> feature).</li>
</ol>
<h2 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>busted_classifier::{classify, Direction};

<span class="kw">let </span>payload = <span class="string">b"POST /v1/chat/completions HTTP/1.1\r\n\
    Host: api.openai.com\r\n\
    Content-Type: application/json\r\n\r\n\
    {\"model\":\"gpt-4\",\"messages\":[]}"</span>;

<span class="kw">let </span>result = classify(payload, Direction::Write, <span class="prelude-val">None</span>);
<span class="macro">assert!</span>(result.is_interesting);
<span class="macro">assert_eq!</span>(result.provider(), <span class="prelude-val">Some</span>(<span class="string">"OpenAI"</span>));
<span class="macro">assert_eq!</span>(result.model(), <span class="prelude-val">Some</span>(<span class="string">"gpt-4"</span>));</code></pre></div><h2 id="feature-flags"><a class="doc-anchor" href="#feature-flags">§</a>Feature Flags</h2>
<ul>
<li><strong><code>pii</code></strong> — Enables PII detection via regex scanning (adds <code>regex</code> dependency).
When disabled, <a href="pii/struct.PiiFlags.html" title="struct busted_classifier::pii::PiiFlags"><code>PiiFlags</code></a> fields are always <code>false</code>.</li>
</ul>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><dl class="item-table reexports"><dt id="reexport.ModelParams"><code>pub use fingerprint::<a class="struct" href="fingerprint/struct.ModelParams.html" title="struct busted_classifier::fingerprint::ModelParams">ModelParams</a>;</code></dt><dt id="reexport.SdkInfo"><code>pub use fingerprint::<a class="struct" href="fingerprint/struct.SdkInfo.html" title="struct busted_classifier::fingerprint::SdkInfo">SdkInfo</a>;</code></dt><dt id="reexport.McpCategory"><code>pub use mcp::<a class="enum" href="mcp/enum.McpCategory.html" title="enum busted_classifier::mcp::McpCategory">McpCategory</a>;</code></dt><dt id="reexport.McpMsgType"><code>pub use mcp::<a class="enum" href="mcp/enum.McpMsgType.html" title="enum busted_classifier::mcp::McpMsgType">McpMsgType</a>;</code></dt></dl><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="fingerprint/index.html" title="mod busted_classifier::fingerprint">fingerprint</a></dt><dd>Agent/SDK fingerprinting from User-Agent headers and request structure.</dd><dt><a class="mod" href="http/index.html" title="mod busted_classifier::http">http</a></dt><dd>HTTP/1.1 request and response parsing via [<code>nom</code>].</dd><dt><a class="mod" href="json/index.html" title="mod busted_classifier::json">json</a></dt><dd>Streaming JSON field extraction (handles truncated payloads).</dd><dt><a class="mod" href="llm/index.html" title="mod busted_classifier::llm">llm</a></dt><dd>LLM API endpoint matching for known providers.</dd><dt><a class="mod" href="mcp/index.html" title="mod busted_classifier::mcp">mcp</a></dt><dd>MCP (Model Context Protocol) JSON-RPC 2.0 detection.</dd><dt><a class="mod" href="pii/index.html" title="mod busted_classifier::pii">pii</a></dt><dd>PII (personally identifiable information) scanning.</dd></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.Classification.html" title="struct busted_classifier::Classification">Classification</a></dt><dd>Full classification result.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.ContentClass.html" title="enum busted_classifier::ContentClass">Content<wbr>Class</a></dt><dd>Layer 2: Content classification.</dd><dt><a class="enum" href="enum.Direction.html" title="enum busted_classifier::Direction">Direction</a></dt><dd>Direction of TLS data flow.</dd><dt><a class="enum" href="enum.Protocol.html" title="enum busted_classifier::Protocol">Protocol</a></dt><dd>Layer 1: Protocol detection result.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.classify.html" title="fn busted_classifier::classify">classify</a></dt><dd>Classify a decrypted TLS payload chunk.</dd></dl></section></div></main></body></html>